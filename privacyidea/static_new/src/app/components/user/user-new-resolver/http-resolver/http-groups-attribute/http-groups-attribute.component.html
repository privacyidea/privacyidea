<!--
 (c) NetKnights GmbH 2026,  https://netknights.it

 This code is free software; you can redistribute it and/or
 modify it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE
 as published by the Free Software Foundation; either
 version 3 of the License, or any later version.

 This code is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 GNU AFFERO GENERAL PUBLIC LICENSE for more details.

 You should have received a copy of the GNU Affero General Public
 License along with this program.  If not, see <http://www.gnu.org/licenses/>.

 SPDX-License-Identifier: AGPL-3.0-or-later
-->

<div
  class="flex-row gap-16 margin-top-16 align-baseline"
  [formGroup]="userGroupsControl">
  <mat-slide-toggle [formControlName]="'active'">
        <span
          class="bold"
          i18n>Groups</span>
  </mat-slide-toggle>
  <mat-form-field
    subscriptSizing="dynamic"
    class="flex-size-1">
    @if (resolverType === "entraidresolver") {
      <mat-label i18n>Group Identifier</mat-label>
    } @else {
      <mat-label i18n>User Store Attribute</mat-label>
    }
    <input
      formControlName="user_groups_attribute"
      matInput />
    @if (resolverType === "entraidresolver") {
      <mat-hint i18n>Group identifier from EntraID mapped to the users group list.</mat-hint>
    } @else {
      <mat-hint i18n>Key of the group's name in the user store response.</mat-hint>
    }
  </mat-form-field>

  @if (resolverType !== "entraidresolver") {
    <mat-form-field class="flex-size-1">
      <mat-label i18n>Method</mat-label>
      <mat-select
        formControlName="method">
        <mat-option value="post">POST</mat-option>
        <mat-option value="get">GET</mat-option>
        <mat-option value="put">PUT</mat-option>
        <mat-option value="patch">PATCH</mat-option>
        <mat-option value="delete">DELETE</mat-option>
      </mat-select>
      <mat-hint i18n>HTTP method for the groups request.</mat-hint>
    </mat-form-field>

    <mat-form-field
      subscriptSizing="dynamic"
      class="flex-size-2">
      <mat-label i18n>Endpoint</mat-label>
      <input
        formControlName="endpoint"
        matInput />
      <mat-hint>
        <span i18n>Endpoint to receive the groups of a specific user. Possible tags:</span>
        <code> &#123;userid&#125;</code>
        @if (resolverType === 'keycloakresolver') {
          <code> &#123;realm&#125;</code>
        }
      </mat-hint>
    </mat-form-field>
  }
</div>
@if (resolverType === "entraidresolver") {
  <div
    class="hint margin-top-8 margin-bottom-16"
    i18n>
    Receive the users groups via the <code>memberOf</code> attribute and store them under the privacyIDEA attribute
    <code>groups</code>.
  </div>
} @else {
  <div
    class="hint margin-top-8 margin-bottom-16"
    i18n>User groups are received in a separate request and stored under the privacyIDEA attribute <code>groups</code>.
  </div>
}