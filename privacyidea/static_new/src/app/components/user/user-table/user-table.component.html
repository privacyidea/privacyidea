<div aria-label="User Layout"
     class="user-layout">
  <div class="user-table-container">
    <div class="filter-paginator-container">
      <mat-form-field class="token-table-filter"
                      subscriptSizing="dynamic">
        <mat-label>Enter Filter</mat-label>
        <input #filterHTMLInputElement
               [(ngModel)]="filterValueString"
               aria-label="Filter Input"
               matInput
               placeholder="Example query: 'type: hotp userid: 1000'" />
      </mat-form-field>
      <mat-paginator [length]="totalLength()"
                     [pageSizeOptions]="pageSizeOptions()"
                     [pageSize]="userService.pageSize()"
                     showFirstLastButtons></mat-paginator>
    </div>
    <app-keyword-filter [advancedApiFilter]="userService.advancedApiFilter"
                        [apiFilter]="userService.apiFilter"
                        [filterHTMLInputElement]="filterHTMLInputElement"
                        [filterValue]="userService.filterValue"></app-keyword-filter>
    <div class="audit-table-overflow">
      <table [dataSource]="usersDataSource()"
             aria-label="User Data Table"
             class="token-table"
             mat-table
             matSort>
        @for (column of columnKeysMap; track column) {
          <ng-container [matColumnDef]="column.key">
            <th *matHeaderCellDef
                attr.aria-label="{{ column.label }} Header"
                mat-sort-header
                mat-header-cell>
              {{ column.label }}
            </th>
            <td *matCellDef="let element; let row"
                attr.aria-label="{{ column.label }} Cell"
                mat-cell
                [ngClass]="{
                'width-18rem': column.key === 'description',
                'table-checkbox': column.key === 'select',
              }">
              <div>
                @switch (column.key) {
                  @case ("username") {
                    <a attr.aria-label="{{ column.label }} Link"
                       [routerLink]="['#', element.username]"> {{ element[column.key] }}
                    </a>
                  }
                  @default {
                    <span>
                      {{ element[column.key] }}
                    </span>
                  }
                }
              </div>
            </td>
          </ng-container>
        }
        <tr *matHeaderRowDef="columnKeys"
            aria-label="Header Row"
            mat-header-row></tr>
        <tr *matRowDef="let row; columns: columnKeys"
            aria-label="Data Row"
            mat-row></tr>
        <tr *matNoDataRow
            aria-label="No Data Row">
          <td [attr.colspan]="columnKeys.length"
              aria-label="No Data Cell">
            No data matching the filter.
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
