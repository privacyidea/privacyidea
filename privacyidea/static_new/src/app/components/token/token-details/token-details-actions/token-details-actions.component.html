@if (overflowService.isWidthOverflowing("body", 1580)) {
  <br />
}
<div
  [ngClass]="{ 'ali-center': overflowService.isWidthOverflowing('body', 1580) }"
  class="actions-otp-container">
  @if (authService.actionAllowed("setpin") || authService.actionsAllowed(["setrandompin", "otp_pin_set_random"])) {
    <div class="user-pin-container">
      <app-set-pin-action
        [repeatPinValue]="repeatPinValue"
        [setPinValue]="setPinValue" />
      <mat-divider class="margin-top-1 margin-bottom-1" />
    </div>
  }
  @if (tokenType() !== "passkey" && authService.actionAllowed("resync")) {
    <app-resync-token-action />
    <mat-divider class="margin-top-1 margin-bottom-1" />
  }
  @if (tokenType() !== "passkey") {
    <app-test-otp-pin-action />
  } @else {
    <button
      (click)="testPasskey()"
      class="action-button-1 width-238"
      i18n
      mat-stroked-button>
      <mat-icon>key</mat-icon>
      Test Passkey
    </button>
  }
  @if (authService.actionsAllowed(["manage_machine_tokens", "machinelist"])) {
    @if (tokenType() === "sshkey") {
      <button
        (click)="attachSshToMachineDialog()"
        class="action-button-1 width-238"
        i18n
        mat-stroked-button>
        <mat-icon>computer</mat-icon>
        Attach to Machine
      </button>
    } @else if (tokenType() === "passkey") {
      @if (isAttachedToMachine()) {
        <button
          (click)="removePasskeyFromMachine()"
          class="action-button-1 width-238"
          i18n
          mat-stroked-button>
          <mat-icon>computer</mat-icon>
          Disable Offline
        </button>
      } @else {
        <button
          (click)="attachPasskeyToMachine()"
          class="action-button-1 width-238"
          i18n
          mat-stroked-button>
          <mat-icon>computer</mat-icon>
          Use Offline
        </button>
      }
    } @else if (tokenType() === "hotp" && !isAttachedToMachine()) {
      <button
        (click)="attachHotpToMachineDialog()"
        class="action-button-1 width-238"
        i18n
        mat-stroked-button>
        <mat-icon>computer</mat-icon>
        Use Offline
      </button>
    }
    <mat-divider class="margin-top-1 margin-bottom-1" />
    @if ((tokenIsActive() && authService.actionAllowed("disable")) ||
    (!tokenIsActive() && authService.actionAllowed("enable"))) {
      <button
        (click)="toggleActive()"
        [disabled]="tokenIsRevoked()"
        [ngClass]="[tokenIsActive()
                      ? 'action-button-delete width-238'
                      : 'action-button-1 width-238'
                ]"
        i18n
        mat-stroked-button>
        <mat-icon>{{ tokenIsActive() ? "lock" : "play_circle" }}</mat-icon>
        {{ tokenIsActive() ? "Deactivate" : "Activate" }}
      </button>
    }
    @if (authService.actionAllowed("delete")) {
      <button
        (click)="deleteToken()"
        class="action-button-delete"
        i18n
        mat-stroked-button>
        <mat-icon> delete</mat-icon>
        Delete
      </button>
    }
    @if (authService.actionAllowed("revoke")) {
      <button
        (click)="revokeToken()"
        [disabled]="tokenIsRevoked()"
        class="action-button-delete"
        i18n
        mat-stroked-button>
        <mat-icon>undo</mat-icon>
        Revoke
      </button>
    }
    @if (authService.actionAllowed("losttoken")) {
      <button
        (click)="openLostTokenDialog()"
        class="action-button-1 width-238"
        i18n
        mat-stroked-button>
        <mat-icon>remove_red_eye</mat-icon>
        Lost Token
      </button>
    }
  }
</div>
