@if (overflowService.isWidthOverflowing("body", 1580)) {
  <br/>
}
<div
  [ngClass]="{
      'ali-center': overflowService.isWidthOverflowing('body', 1580),
    }"
  class="actions-otp-container">
  <div class="user-pin-container user-pin-container-padding">
    @if (tokenType() !== "passkey") {
      <div class="user-pin-input">
        <input
          style="display: none"
          type="text"/>

        <input
          style="display: none"
          type="password"/>

        <input
          [(ngModel)]="setPinValue"
          [type]="'password'"
          class="input"
          placeholder="Token PIN"/>

        <input
          [(ngModel)]="repeatPinValue"
          [type]="'password'"
          class="input"
          placeholder="Repeat PIN"/>
      </div>
      <div class="user-pin-button">
        <button
          (click)="setPin()"
          class="detail-button"
          extended
          mat-fab>
          <mat-icon class="detail-button-icon">password</mat-icon>
          Set PIN
        </button>
        @if (canSetRandomPin()) {
          <button
            (click)="setRandomPin()"
            class="detail-button"
            extended
            mat-fab>
            <mat-icon class="detail-button-icon">casino</mat-icon>
            Random PIN
          </button>
        }
      </div>
    }
    <br/>
    <mat-divider/>
    <br/>
  </div>
  <div class="actions-pin-input">
    <input
      [(ngModel)]="fristOTPValue"
      class="input"
      placeholder="First OTP"/>

    <input
      [(ngModel)]="secondOTPValue"
      class="input"
      placeholder="Second OTP"/>
  </div>
  <div class="actions-pin-input-button">
    <button
      (click)="resyncOTPToken()"
      class="detail-button"
      extended
      mat-fab>
      <mat-icon class="detail-button-icon">sync</mat-icon>
      Resync Token
    </button>
  </div>
  <br/>
  <mat-divider/>
  <br/>
  @if (tokenType() !== 'passkey') {
    <div class="actions-otp-pin-input">
      <input
        style="display: none"
        type="text"/>

      <input
        style="display: none"
        type="password"/>

      <mat-form-field class="width-100">
        <mat-label>OTP or Pin</mat-label>

        <input
          matInput
          [(ngModel)]="otpOrPinToTest"
          [type]="hide ? 'password' : 'text'"
          autocomplete="one-time-code">

        <button
          mat-icon-button
          matSuffix
          type="button"
          (click)="hide = !hide"
          [attr.aria-label]="hide ? 'Show value' : 'Hide value'">
          <mat-icon>{{ hide ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </mat-form-field>
    </div>
    <div class="actions-pin-button">
      <button
        (click)="testToken()"
        class="detail-button"
        extended
        mat-fab>
        <mat-icon class="detail-button-icon">help_outline</mat-icon>
        Test Token
      </button>
      <button
        (click)="verifyOTPValue()"
        class="detail-button"
        extended
        mat-fab>
        <mat-icon class="detail-button-icon">help_outline</mat-icon>
        Verify OTP Value
      </button>
      @if (tokenType() === 'sshkey') {
        <button
          (click)="assignSSHMachineDialog()"
          class="detail-button"
          extended
          mat-fab>
          <mat-icon class="detail-button-icon">computer</mat-icon>
          Assign SSH Machine
        </button>
      }
    </div>
  } @else {
    <button
      (click)="testPasskey()"
      class="detail-button"
      extended
      mat-fab>
      <mat-icon class="detail-button-icon">key</mat-icon>
      Test Passkey
    </button>
  }
</div>
