<mat-expansion-panel
  class="token-card"
  [disabled]="childHadNoForm()">
  <mat-expansion-panel-header>
    <mat-panel-title>
      {{ token().type }}
    </mat-panel-title>
    <div class="token-actions">
      @if (isEditMode()) {
        <button
          mat-icon-button
          (click)="deleteToken(); $event.stopPropagation()">
          <mat-icon>delete</mat-icon>
        </button>
      }
    </div>
  </mat-expansion-panel-header>
  @switch (token().type) {
    @case ("hotp") {
      <app-enroll-hotp
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        [disabled]="!isEditMode()" />
    }
    @case ("totp") {
      <app-enroll-totp
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        [disabled]="!isEditMode()" />
    }
    @case ("spass") {
      <app-enroll-spass (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("remote") {
      <app-enroll-remote (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("sms") {
      <app-enroll-sms (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("4eyes") {
      <app-enroll-foureyes
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        [disabled]="!isEditMode()" />
    }
    @case ("applspec") {
      <app-enroll-applspec
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        [disabled]="!isEditMode()" />
    }
    @case ("daypassword") {
      <app-enroll-daypassword
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        [disabled]="!isEditMode()" />
    }
    @case ("email") {
      <app-enroll-email
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        [disabled]="!isEditMode()" />
    }
    @case ("indexedsecret") {
      <app-enroll-indexedsecret (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("paper") {
      <app-enroll-paper (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("push") {
      <app-enroll-push (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("registration") {
      <app-enroll-registration (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("tan") {
      <app-enroll-tan (additionalFormFieldsChange)="updateAdditionalFormFields($event)" />
    }
    @case ("tiqr") {
      <app-enroll-tiqr
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        [disabled]="!isEditMode()" />
    }
    @default {}
  }
</mat-expansion-panel>
