<mat-expansion-panel class="token-card">
  <mat-expansion-panel-header>
    <mat-panel-title>
      {{ token().type }}
    </mat-panel-title>
    <div class="token-actions">
      @if (isEditMode()) {
        <button
          mat-icon-button
          (click)="deleteToken(); $event.stopPropagation()">
          <mat-icon>delete</mat-icon>
        </button>
      }
    </div>
  </mat-expansion-panel-header>
  @switch (token().type) {
    @case ("hotp") {
      <app-enroll-hotp
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("totp") {
      <app-enroll-totp
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("spass") {
      <app-enroll-spass
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("remote") {
      <app-enroll-remote
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("sms") {
      <app-enroll-sms
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("4eyes") {
      <app-enroll-foureyes
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("applspec") {
      <app-enroll-applspec
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("daypassword") {
      <app-enroll-daypassword
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("email") {
      <app-enroll-email
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("indexedsecret") {
      <app-enroll-indexedsecret
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("paper") {
      <app-enroll-paper
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("push") {
      <app-enroll-push
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("registration") {
      <app-enroll-registration
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("tan") {
      <app-enroll-tan
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
    @case ("tiqr") {
      <app-enroll-tiqr
        (additionalFormFieldsChange)="updateAdditionalFormFields($event)"
        (clickEnrollChange)="updateClickEnroll($event)" />
    }
  }
  <!-- <div class="token-details-form">
    <mat-slide-toggle
      [disabled]="!isEditMode()"
      [ngModel]="token().genkey"
      (ngModelChange)="updateToken({ genkey: $event })"
      name="genkey">
      Generate Key
    </mat-slide-toggle>
    <mat-slide-toggle
      [disabled]="!isEditMode()"
      [ngModel]="token().user"
      (ngModelChange)="updateToken({ user: $event })"
      name="user">
      User Token
    </mat-slide-toggle>
    <mat-form-field>
      <mat-label>OTP Length</mat-label>
      <input
        [disabled]="!isEditMode()"
        matInput
        type="number"
        [ngModel]="token().otplen"
        (ngModelChange)="updateToken({ otplen: +$event })"
        name="otplen" />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Time Step</mat-label>
      <input
        [disabled]="!isEditMode()"
        matInput
        type="number"
        [ngModel]="token().timeStep"
        (ngModelChange)="updateToken({ timeStep: +$event })"
        name="timeStep" />
    </mat-form-field>

    <mat-form-field>
      <mat-label>Hashlib</mat-label>
      <mat-select
        [disabled]="!isEditMode()"
        [ngModel]="token().hashlib"
        (ngModelChange)="updateToken({ hashlib: $event })"
        name="hashlib">
        <mat-option value="sha1">SHA1</mat-option>
        <mat-option value="sha256">SHA256</mat-option>
        <mat-option value="sha512">SHA512</mat-option>
      </mat-select>
    </mat-form-field>
  </div> -->
</mat-expansion-panel>
