<div aria-label="Token Layout" class="token-layout">
  @if (
    !overflowService.isWidthOverflowing(
      ".token-layout",
      overflowService.getOverflowThreshold(selectedContent())
    )
  ) {
    <app-token-card
      class="margin-right-1"
      [active]="tokenIsActive"
      [states]="states"
      [refreshTokenDetails]="refreshTokenDetails"
      [refreshContainerDetails]="refreshContainerDetails"
      [revoked]="revoked"
      [tokenSerial]="tokenSerial"
      [containerSerial]="containerSerial"
      [isProgrammaticChange]="isProgrammaticChange"
      [selectedContent]="selectedContent" />
  }
  <mat-drawer-container>
    @if (
      overflowService.isWidthOverflowing(
        ".token-layout",
        overflowService.getOverflowThreshold(selectedContent())
      )
    ) {
      <mat-drawer
        #drawer
        [mode]="'over'"
        [ngClass]="[
          this.overflowService.isHeightOverflowing(
            '.mat-drawer-inner-container',
            543
          )
            ? 'token-drawer-overflow'
            : 'token-drawer',
        ]">
        <app-token-card
          [active]="tokenIsActive"
          [states]="states"
          [refreshTokenDetails]="refreshTokenDetails"
          [refreshContainerDetails]="refreshContainerDetails"
          [revoked]="revoked"
          [tokenSerial]="tokenSerial"
          [containerSerial]="containerSerial"
          [isProgrammaticChange]="isProgrammaticChange"
          [selectedContent]="selectedContent" />
      </mat-drawer>
    }
    <mat-drawer-content>
      <div class="drawer-content-div">
        @if (
          overflowService.isWidthOverflowing(
            ".token-layout",
            overflowService.getOverflowThreshold(selectedContent())
          )
        ) {
          <div class="drawer-button-div">
            <button mat-fab (click)="drawer.toggle()" class="drawer-button">
              <mat-icon>keyboard_arrow_right</mat-icon>
            </button>
          </div>
        }
        <main>
          <div
            [ngClass]="[
              overflowService.isWidthOverflowing(
                '.token-layout',
                overflowService.getOverflowThreshold(selectedContent())
              )
                ? 'main-margin'
                : 'main-margin-overflow',
            ]">
            @switch (selectedContent()) {
              @case ("token_overview") {
                <app-token-table
                  [tokenSerial]="tokenSerial"
                  [containerSerial]="containerSerial"
                  [isProgrammaticChange]="isProgrammaticChange"
                  [selectedContent]="selectedContent" />
              }
              @case ("token_enrollment") {
                <app-token-enrollment
                  [tokenSerial]="tokenSerial"
                  [containerSerial]="containerSerial"
                  [selectedContent]="selectedContent"
                  [isProgrammaticChange]="isProgrammaticChange" />
              }
              @case ("token_details") {
                <app-token-details
                  #tokenDetailsComponent
                  [tokenSerial]="tokenSerial"
                  [active]="tokenIsActive"
                  [revoked]="revoked"
                  [refreshTokenDetails]="refreshTokenDetails"
                  [containerSerial]="containerSerial"
                  [selectedContent]="selectedContent"
                  [isProgrammaticChange]="isProgrammaticChange" />
              }

              @case ("container_overview") {
                <app-container-table
                  [containerSerial]="containerSerial"
                  [selectedContent]="selectedContent" />
              }
              @case ("container_details") {
                <app-container-details
                  #containerDetailsComponent
                  [containerSerial]="containerSerial"
                  [tokenSerial]="tokenSerial"
                  [states]="states"
                  [refreshContainerDetails]="refreshContainerDetails"
                  [selectedContent]="selectedContent"
                  [isProgrammaticChange]="isProgrammaticChange" />
              }
              @case ("show_challenges") {
                <app-challenges-table
                  [selectedContent]="selectedContent"
                  [tokenSerial]="tokenSerial" />
              }
              @case ("token_applications") {
                <app-token-applications
                  [tokenSerial]="tokenSerial"
                  [selectedContent]="selectedContent" />
              }
              @case ("token_get_serial") {
                <app-token-get-serial
                  [tokenSerial]="tokenSerial"
                  [selectedContent]="selectedContent" />
              }
            }
          </div>
        </main>
      </div>
    </mat-drawer-content>
  </mat-drawer-container>
</div>
